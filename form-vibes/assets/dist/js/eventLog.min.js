import{x as l,L as N,o as v,E as m,w as b,k as e,h as s,l as w,Z as J,g as k,W as A,X as F,t as L,J as O,Q as $,A as q,a4 as G,j as M,s as Q,ad as U,ae as W,af as X}from"../assets/post-2433f428.js";import{v as Z}from"../assets/loading-128c1aab.js";import{E as H,a as K,b as Y}from"../assets/table-column-20765d73.js";import{u as P,s as D}from"../assets/formvibes-4c4994e4.js";import"../assets/select-b70937af.js";import"../assets/checkbox-84ab24fd.js";import{_ as ee}from"../assets/header-7033ae65.js";import{V as te}from"../assets/vue-resizable.umd.min-e42f227d.js";import"../assets/focus-trap-9b255300.js";const ae={class:"resizable-content"},se={class:"fv-expand-content-wrapper"},ne={class:"fv-expand-content"},oe={__name:"log-expand-data",props:["row","closeExpand"],setup(a){const t=P(),n=l(["lb","l","lt"]),{generalStates:r,size:i}=N(t),o=e=>{const a=e.width,s=e.height;Number(a)<=400?D("fv-sidebar",{width:400,height:a}):D("fv-sidebar",{width:a,height:s}),r.value.size={width:a,height:s}};return(t,l)=>{const r=O;return v(),m(w(te),{class:"fv-side-panel",width:w(i).width,active:n.value,height:"100%",style:{position:"fixed",left:"unset",right:"0","z-index":"99999",cursor:"unset"},"onResize:end":o},{default:b((()=>[e("div",ae,[e("div",se,[s(r,{class:"fv-cursor",size:"20",onClick:a.closeExpand},{default:b((()=>[s(w(J))])),_:1},8,["onClick"]),e("div",ne,[e("dl",null,[(v(!0),k(A,null,F(a.row,((a,s,t)=>(v(),k("div",{class:"fv-expand-row",key:t},[e("dt",null,L(s),1),e("dd",null,[e("span",null,L(a),1)])])))),128))])])])])])),_:1},8,["width","active"])}}},le={class:"fv-content-wrapper"},ie=e("div",{class:"fv-page-title"},[e("h3",null,"Event Log")],-1),re={class:"fv-event-log-wrapper"},ce={class:"fv-table-pagination"},pe={__name:"event-log",setup(a){const t=P(),{pageSizes:n}=N(t),r=l(!1),i=l(10),o=l(1),p=l([]),u=l(0),d=l(""),c=l(!1),f=e=>{i.value=parseInt(e)},g=window.fvGlobalVar?.i18n,h=e=>{o.value=parseInt(e)};$([i,o],(()=>{_()})),q((()=>{_()}));const _=async()=>{r.value=!0;const{data:{count:e,data:a}}=await z();u.value=parseInt(e);const s=a.map((e=>{let{description:a,event:s}=e;if((e=>{try{return"object"==typeof JSON.parse(e)}catch{return!1}})(e.description)&&"edit-data"===s){const s=JSON.parse(e.description);a=`Entry ID: ${s.entry_id},${g?.field_name}: ${s.field_name}\n                ${s.value.prev_value} => ${s.value.next_value}`}return{...e,description:a,event:s}}));p.value=s,r.value=!1},z=async()=>{const e=o.value,a=i.value;return await G({action:"fv_event_logs",queryParams:{page:e,pageSize:a}})},x=e=>{d.value=e},j=()=>{d.value=""};return $(d,(()=>{d.value?c.value=!0:c.value=!1})),(a,t)=>{const l=H,g=K,_=Y,z=U,k=Z;return v(),m(z,null,{default:b((()=>[e("div",null,[s(ee),e("div",le,[ie,e("div",re,[M((v(),m(g,{data:p.value,onRowClick:x},{default:b((()=>[s(l,{prop:"serial_number",label:"S/N",width:"80"}),s(l,{prop:"user",label:"User",width:"180"}),s(l,{prop:"event",label:"Event",width:"180"}),s(l,{prop:"description",label:"Description"}),s(l,{prop:"export_time_gmt",label:"Time",width:"200"})])),_:1},8,["data"])),[[k,r.value]]),e("div",ce,[s(_,{class:"fv-pagination",layout:"total, sizes, prev, pager, next",total:u.value,"current-page":o.value,"page-sizes":w(n),"page-size":i.value,onSizeChange:f,onCurrentChange:h,background:""},null,8,["total","current-page","page-sizes","page-size"])])])]),c.value?(v(),m(oe,{key:0,row:d.value,closeExpand:j},null,8,["row"])):Q("",!0)])])),_:1})}}},de=W(),V=X(pe);V.use(de),V.mount("#fv-event-log-wrapper");