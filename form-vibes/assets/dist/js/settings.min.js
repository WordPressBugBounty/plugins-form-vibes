import{L as R,x as k,c as H,o as i,g as h,k as e,W as I,X as G,t as C,s as E,q as _,E as V,l as n,ai as F,aj as K,h as t,w as o,ak as D,ab as L,O as Q,P as M,J as O,al as W,am as X,Q as B,A as Y,aa as z,an as j,ao as T,a4 as Z,ap as ee,aq as te,ad as ne,ae as oe,af as ae}from"../assets/post-2433f428.js";import{u as N,E as le}from"../assets/formvibes-4c4994e4.js";import{E as se,a as ie}from"../assets/tab-pane-95a99d05.js";import{_ as re}from"../assets/header-7033ae65.js";import{E as J}from"../assets/switch-6d25050e.js";import{E as $}from"../assets/index-8e3cc18a.js";import{E as ce,a as ue}from"../assets/collapse-item-ac72ec57.js";import{E as P}from"../assets/index-2f3cc352.js";import"../assets/vnode-5543c613.js";import"../assets/index-fb3a1e53.js";const de=(e,t)=>{const a=e.__vccOpts||e;for(const[e,l]of t)a[e]=l;return a},pe=e=>(W("data-v-48be8a7e"),e=e(),X(),e),_e={key:0},ve={key:1},me=pe((()=>e("span",null,"( In seconds )",-1))),fe={__name:"settings-content",setup(a){const{settings_default:l,settings_saved:s}=window.fvGlobalVar,r=N(),{isSaving:u}=R(r),c=k([]),d=k([]);c.value=Object.entries(l).map((([e,t])=>({label:t.label,type:t.type,value:s[e],setting:e}))),d.value=JSON.parse(JSON.stringify(c.value));const p=H((()=>c.value.some(((e,t)=>e.value!==d.value[t].value)))),v=()=>{const e={...s};c.value.forEach((({setting:t,value:a})=>{e[t]=a})),r.saveSettings(e),d.value=JSON.parse(JSON.stringify(c.value))},f=()=>{r.resetSettings(),setTimeout((()=>{window.location.reload()}),1e3)};return(a,l)=>{const s=J,r=M,d=O,m=$;return i(),h("div",null,[e("div",null,[e("ul",null,[(i(!0),h(I,null,G(c.value,((t,a)=>(i(),h("li",{key:a},[e("div",null,["input"!==t.type?(i(),h("p",_e,C(t.label),1)):E("",!0),"input"===t.type&&c.value.filter((e=>"auto_refresh"===e.setting))[0]?.value?(i(),h("p",ve,[_(C(t.label)+" ",1),me])):E("",!0)]),e("div",null,["toggle"===t.type?(i(),V(s,{key:0,modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,style:{"margin-left":"24px"},"inline-prompt":"","active-icon":n(F),"inactive-icon":n(K)},null,8,["modelValue","onUpdate:modelValue","active-icon","inactive-icon"])):E("",!0),"input"===t.type&&c.value.filter((e=>"auto_refresh"===e.setting))[0]?.value?(i(),V(r,{key:1,modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,"inline-prompt":""},null,8,["modelValue","onUpdate:modelValue"])):E("",!0)])])))),128))]),e("div",null,[t(m,{type:"primary",class:"fv-save-button",disabled:!p.value||n(u),onClick:v},{default:o((()=>[n(u)?(i(),V(d,{key:1,class:"is-loading"},{default:o((()=>[t(n(L))])),_:1})):(i(),V(d,{key:0},{default:o((()=>[t(n(D))])),_:1})),_(" Save Setting ")])),_:1},8,["disabled"]),t(m,{type:"danger",class:"fv-reset-button",icon:n(Q),plain:"",onClick:f},{default:o((()=>[_(" Reset ")])),_:1},8,["icon"])])])])}}},he=de(fe,[["__scopeId","data-v-48be8a7e"]]),be={class:"fv-feature-heading"},ge={__name:"role-content",props:["role","roleKey","setCap","caps"],setup(a){const l=a,n=k([]);B((()=>{const e=l.role.capabilities,{capabilities:t}=window.fv_role_manager_data,a={};Object.keys(t).forEach((l=>{a[l]={},Object.keys(t[l]).forEach((n=>{a[l][n]={label:t[l][n],enabled:e[n]??!1}}))})),n.value=a}));return(s,o)=>{const r=J;return i(),h("div",null,[e("div",null,[e("div",null,[(i(!0),h(I,null,G(n.value,((n,o,u)=>(i(),h("div",{key:u},[e("span",be,C(o.charAt(0).toUpperCase()+o.substring(1)),1),e("ul",null,[(i(!0),h(I,null,G(n,((n,o,u)=>(i(),h("li",{key:u},[e("div",null,[t(r,{modelValue:n.enabled,"onUpdate:modelValue":e=>n.enabled=e,style:{"margin-left":"24px","margin-right":"15px"},"inline-prompt":"","active-icon":s.Check,"inactive-icon":s.Close,onChange:e=>((e,t,a)=>{l.setCap({...l.caps,[a]:{...l.caps[a],[t]:e}})})(e,o,a.roleKey)},null,8,["modelValue","onUpdate:modelValue","active-icon","inactive-icon","onChange"]),e("span",null,C(n.label),1)])])))),128))])])))),128))])])])}}},ye={__name:"role-manager",setup(a){const l=N(),{isSaving:s}=R(l),r=k({});k(window.fv_role_manager_data.roles);const u=k(window.fv_role_manager_data.roles),c=k([]);Y((()=>{u.value=Object.fromEntries(Object.entries(u.value).filter((([e,t])=>"administrator"!==e)))}));const d=e=>{r.value=e},p=()=>{l.saveRoles(r.value)};return(a,l)=>{const v=ce,f=ue,m=O,b=$;return i(),h("div",null,[t(f,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=e=>c.value=e)},{default:o((()=>[(i(!0),h(I,null,G(u.value,((a,l,n)=>(i(),V(v,{title:a.name,key:n},{title:o((()=>[e("h4",null,C(a.name),1)])),default:o((()=>[t(ge,{roleKey:l,role:u.value[l],setCap:d,caps:r.value},null,8,["roleKey","role","caps"])])),_:2},1032,["title"])))),128))])),_:1},8,["modelValue"]),t(b,{onClick:p,type:"primary",class:"fv-save-button"},{default:o((()=>[n(s)?(i(),V(m,{key:0},{default:o((()=>[t(n(L))])),_:1})):E("",!0),_(" Save Settings ")])),_:1})])}}},we={class:"fv-gsheet-wrapper"},ke={class:"fv-gsheet-controls"},Ce={class:"fv-gsheet-control-wrapper gsheet-status"},Se={class:""},Ve={class:"fv-gsheet-control-wrapper"},Ee={class:"fv-gsheet-control-wrapper"},Ae={class:"fv-gsheet-description"},Ue={style:{"margin-left":"1em"}},xe=T('<li> Go to <a target="_blank" rel="noopener noreferrer" href="https://console.developers.google.com/"> Google Developer Console </a> and create a <b>New Project</b>. </li><li> Now select the newly created project from the projects dropdown. </li><li>From the left sidebar, go to API &amp; Services -&gt; Library.</li><li> Search for <b>Google Sheets API</b> and <b>Google Drive API</b>, open each one, and click Enable to turn them on. </li><li> On the left menu, select <b>OAuth Consent Screen</b> and then click <b>Get Started</b>. </li><li> Add your <b>App name</b> and Support email, then click Next. Choose <b>External</b> as the audience. </li><li> Add your <b>Contact info</b>, agree to the terms, and click <b>Create</b>. </li><li>On the left menu, click <b>Branding</b>, scroll down to <b>Authorized Domains</b>, and click <b>Add Domain.</b></li>',8),Ne=e("b",null,"Authorized domain.",-1),Ie=T("<li> Go to the Audience menu in the sidebar and click <b>Publish App.</b></li><li> Now, go to the client option in the side menu and click on <b>Create Client</b> button. </li><li>Choose your <b>App type</b> and enter a name.</li><li> Now go to <b>Authorised redirect URIs</b> and click <b>Add URI</b> . </li>",4),Ge=e("b",null,"Authorized redirect URIs",-1),Oe=e("b",null,"Create",-1),Pe=e("br",null,null,-1),Re=e("span",{class:"fv-gsheet-note"}," Note: It may take five minutes to a few hours for settings to take effect. ",-1),Te=T('<li> Copy <b>Client ID</b> and <b>Client Secret</b> from newly created app and put them in their respective fields(on the left). </li><li> Click <b>Authenticate</b>, if appears <b>App is not verified</b> error click <b>show advanced</b> and then <b>Go to App</b>. <br><span class="fv-ghseet-note"> Note: Please check all the required scopes(permissions) when you Authenticate. </span></li>',2),$e={key:0},ze=e("h3",null,"Re Authenticate?",-1),je=e("span",null,[_(" Try re-authorizing if you face issues. Go to "),e("a",{target:"_blank",rel:"noopener noreferrer",href:"https://myaccount.google.com/permissions"},[e("b",null,"Google App Permissions")]),_(" and hit "),e("b",null,"REMOVE ACCESS"),_(" on any previous authorization of this app. Now click on the "),e("b",null,"Re Authenticate"),_(" button and finish the authorization process again. ")],-1),De=[ze,je],Le={__name:"gsheet",setup(a){N();const l=window.fvGlobalVar?.i18n,s=k(window.fvGlobalVar?.is_authenticated||!1),r=k(window.fvGlobalVar?.client_id||""),u=k(window.fvGlobalVar?.client_secret||""),c=k(!1),d=window?.fvGlobalVar?.tld||window?.fvGlobalVar?.domain?.host;let p=window?.fvGlobalVar.rest_url;p+="form-vibes/googlesheets";const v=async()=>{c.value=!0;try{const{data:e}=await Z({queryParams:{client_id:r.value,client_secret:u.value},action:"fv_google_sheet_authenticate"});if(e.success){const t=e.data;window.location.href=t}}catch(e){console.log("error",e.message)}finally{c.value=!1}},f=()=>{navigator.clipboard.writeText(p),P({offset:30,type:"success",dangerouslyUseHTMLString:!0,message:"<strong>URI copied to clipboard</strong>"})},m=()=>{navigator.clipboard.writeText(d),P({offset:30,dangerouslyUseHTMLString:!0,message:"<strong>Host name copied to clipboard</strong>",type:"success"})};return(a,b)=>{const g=le,y=M,k=$,w=O;return i(),h("div",null,[e("div",we,[e("div",ke,[e("div",Ce,[e("span",Se,C(n(l)?.status),1),t(g,{class:"box-item",type:s.value?"success":"danger",effect:"light"},{default:o((()=>[_(C(s.value?"Connected":"Not Connected"),1)])),_:1},8,["type"])]),e("div",Ve,[e("span",null,C(n(l)?.client_id),1),e("div",null,[t(y,{modelValue:r.value,"onUpdate:modelValue":b[0]||(b[0]=e=>r.value=e),placeholder:"Enter a client ID"},null,8,["modelValue"])])]),e("div",Ee,[e("span",null,C(n(l)?.client_secret),1),e("div",null,[t(y,{modelValue:u.value,"onUpdate:modelValue":b[1]||(b[1]=e=>u.value=e),placeholder:"Enter a client secret"},null,8,["modelValue"])])]),e("div",null,[t(k,{type:"primary",onClick:v,class:"fv-save-button"},{default:o((()=>[_(C(c.value?n(l)?.authenticating:s.value?n(l)?.re_authenticate:n(l)?.authenticate),1)])),_:1})])]),e("div",Ae,[e("h3",null,C(n(l)?.instructions),1),e("ol",Ue,[xe,e("li",null,[_(" Copy the URL "),e("b",null,[t(y,{readonly:"",style:{"background-color":"transparent",width:"240px"},value:n(d),size:"small",class:"fv-googlesheet-input"},{suffix:o((()=>[t(w,{onClick:z(m,["stop"]),size:"18"},{default:o((()=>[t(n(j))])),_:1})])),_:1},8,["value"])]),_(" and paste it in the "),Ne]),Ie,e("li",null,[_(" Paste this URL "),e("b",null,[e("i",null,[t(y,{readonly:"",style:{"background-color":"transparent",width:"450px"},value:`${n(p)}`,size:"small",class:"fv-gsheet-input"},{suffix:o((()=>[t(w,{onClick:z(f,["stop"]),size:"18"},{default:o((()=>[t(n(j))])),_:1})])),_:1},8,["value"])])]),_(" in "),Ge,_(", click "),Oe,_(". "),Pe,Re]),Te]),s.value?(i(),h("div",$e,De)):E("",!0)])])])}}},Me={class:"fv-settings-wrapper fv-pr-5"},Be={__name:"settings",setup(a){const l=k(window.location.hash.replace("#","")||"settings"),s=N(),{notice:r,isPro:u}=R(s),c=(e,t)=>{window.location.hash=e};return B([r],(()=>{P({offset:30,dangerouslyUseHTMLString:!0,message:`<strong>${r.value.message}</strong>`,type:r.value.isError?"error":"success",class:"fv-items-center"})})),(a,s)=>{const r=O,d=se,p=ie;return i(),h("div",null,[t(re),e("div",Me,[t(p,{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=e=>l.value=e),type:"card",class:"fv-settings-tab",onTabChange:c},{default:o((()=>[t(d,{name:"settings"},{label:o((()=>[t(r,null,{default:o((()=>[t(n(D))])),_:1}),_(" Settings ")])),default:o((()=>[t(he)])),_:1}),n(u)?(i(),V(d,{key:0,name:"rolemanager"},{label:o((()=>[t(r,null,{default:o((()=>[t(n(ee))])),_:1}),_(" Role Manager ")])),default:o((()=>[t(ye)])),_:1})):E("",!0),n(u)?(i(),V(d,{key:1,name:"gsheet"},{label:o((()=>[t(r,null,{default:o((()=>[t(n(te))])),_:1}),_(" Google Sheet ")])),default:o((()=>[t(Le)])),_:1})):E("",!0)])),_:1},8,["modelValue"])])])}}},Je={__name:"settings",setup(a){const l=N();return(a,s)=>{const r=ne;return i(),V(r,null,{default:o((()=>[e("div",null,[t(Be,{store:n(l)},null,8,["store"])])])),_:1})}}},qe=oe(),q=ae(Je);q.use(qe),q.mount("#fv-settings-general");