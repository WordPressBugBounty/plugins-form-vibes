import{x as p,Q as S,o as n,g as i,h as o,l as s,k as e,t as r,w as f,cs as I,ct as M,J as z,W as q,X as O,L as J,A as Q,a4 as X,E as F,ad as H,ae as K,af as Y}from"../assets/post-2433f428.js";import{u as Z,g as x,c as aa,s as A}from"../assets/formvibes-4c4994e4.js";import{b as ea,d as ta,c as la}from"../assets/select-b70937af.js";import{C as sa,p as oa,a as na,b as ra,B as da,c as ca,L as ua,P as ia,d as va,f as ma}from"../assets/index-4baa6a2e.js";import{E as fa,a as _a}from"../assets/collapse-item-ac72ec57.js";import{_ as pa}from"../assets/date-picker-25a0adc5.js";/* empty css                             */import"../assets/focus-trap-9b255300.js";import"../assets/index-fb3a1e53.js";import"../assets/date-picker-1de719c3.js";import"../assets/index-8e3cc18a.js";const ha={class:"fv-chart"},ba={__name:"chart",props:["chartData","chartType","chartOptions"],setup(t){sa.register(oa,na,ra,da,ca,ua,ia,va);const d=t,_=p({labels:[],datasets:[{label:"",data:[]}]});return S([()=>d.chartData],()=>{_.value={labels:d.chartData.labels,datasets:d.chartData.datasets}}),(c,l)=>(n(),i("div",ha,[o(s(ma),{data:_.value,height:"100%",width:"100%",options:t.chartOptions},null,8,["data","options"])]))}},ga={class:"fv-stats"},ya={class:"fv-count fv-stats-col"},Da={className:"fv-text-xl"},wa={key:0},ka={key:1},Ca={key:0,class:"fv-cmpr fv-stats-col"},Ea={key:1,class:"fv-cmpr fv-stats-col"},Pa={key:0},$a={key:1},Sa={__name:"stats",props:["dashboardData","date","preset"],setup(t){const d=t,_=p(0);return S([()=>d.dashboardData],()=>{let c=Number(d.dashboardData?.previousDateRangeDataCount),l=Number(d.dashboardData?.totalEntries);c<=0||(_.value=Math.ceil((l-c)/c*100))}),(c,l)=>{const D=z;return n(),i("div",ga,[e("div",ya,[e("span",Da,r(t.dashboardData?.totalEntries),1),t.preset!=="Custom"?(n(),i("div",wa,r(t.preset.replaceAll("_"," ")),1)):(n(),i("div",ka,r(t.date[0])+" - "+r(t.date[1]),1))]),Number(t.dashboardData?.previousDateRangeDataCount)===0?(n(),i("div",Ca," No Data to Compare! ")):(n(),i("div",Ea,[t.dashboardData?.totalEntries>=Number(t.dashboardData?.previousDateRangeDataCount)?(n(),i("div",Pa,[o(D,null,{default:f(()=>[o(s(I))]),_:1}),e("span",null,r(_.value)+"%",1)])):(n(),i("div",$a,[o(D,null,{default:f(()=>[o(s(M))]),_:1}),e("span",null,r(_.value)+"%",1)]))]))])}}},Va={class:"fv-dbw-form-list"},La={class:"fv-dbw-form-list-count"},Na={__name:"entry-count",props:["dashboardData","date"],setup(t){const d=p(!1),_=c=>{d.value=!d.value};return(c,l)=>{const D=fa,V=_a;return n(),i("div",null,[o(V,{modelValue:c.activeNames,"onUpdate:modelValue":l[0]||(l[0]=g=>c.activeNames=g),onChange:_},{default:f(()=>[o(D,{title:`Total Entries By Forms (${t.date[0]} to ${t.date[1]}) `},{default:f(()=>[(n(!0),i(q,null,O(t.dashboardData?.allFormsDataCount,(g,w)=>(n(),i("div",{key:w,class:"fv-dbw-form-list-item"},[e("span",Va,r(g.formName)+" ("+r(g.plugin)+") ",1),e("span",La,r(g.count),1)]))),128))]),_:1},8,["title"])]),_:1},8,["modelValue"])])}}},Fa={className:"fv-hidden",id:"fv-dashboard-settings"},qa={class:"fv-row fv-form-row"},Oa={class:"fv-form-row-label"},Ba={class:"fv-row fv-form-row"},xa={class:"fv-row fv-form-row"},Aa={__name:"dashboard",setup(t){const d=Z(),{formsSelector:_,isLoading:c,generalStates:l,currentForm:D,currentPlugin:V,notice:g,dates:w,preset:T}=J(d),h=_.value,b=window.fvGlobalVar?.i18n,k=p(x("fv-form")),C=p(x("fv-analytics-filter")||"month"),B=p([]),W=p({scales:{y:{min:0,ticks:{stepSize:1}}}});p("bar");const U=p([]),L=p([]);Q(()=>{if(!k.value){const v=h[0]?.label,a=h[0]?.options[0]?.value;k.value=a,l.value.queryParams={...l.value.queryParams,plugin:v,formid:a}}N()}),S([k,()=>l.value.queryParams],()=>{N()});const j=(v,a)=>{const u=h.filter(P=>P.label===a.label)[0].options.filter(P=>P.value===v)[0];aa(!0),A("fv-form",u);const m=u.plugin,E=u.value;V.value=m,D.value=E,l.value={...l.value,queryParams:{...l.value.queryParams,plugin:m||(h?.length>0?h[0]?.options[0]?.plugin:[]),formid:E||(h?.length>0?h[0]?.options[0]?.value:[])}}},N=async()=>{c.value=!0;let{queryParams:v}=l.value;v={...v,fromDate:w.value[0]||"",toDate:w.value[1]||""};try{const{data:a}=await X({queryParams:{...v,dashboard_data:!0,allForms:h},action:"fv_get_analytics_data"}),{dashboard_data:u,...m}=a;L.value=u,G(m),d.resetError()}catch(a){g.value={...g.value,isError:!0,message:a.message}}finally{c.value=!1}};S([C],()=>{A("fv-analytics-filter",C.value),l.value={...l.value,queryParams:{...l.value.queryParams,filter_type:C.value}},N()});const G=v=>{const a=[];a.labels=[],a.datasets=[],a.data=[],Object.keys(v).forEach(m=>{a.labels.push(v[m].Label),a.data.push(v[m].count)});const u={labels:a.labels,datasets:[{label:"Leads",backgroundColor:"#0071a14D",borderColor:"#0071a1",borderWidth:3,hoverBackgroundColor:"#00aadc",data:a.data}]};Object.keys(u).length>0&&(B.value=u),U.value=a.data.every(m=>m===0),c.value=!1};return(v,a)=>{const u=ea,m=ta,E=la,P=H;return n(),F(P,null,{default:f(()=>[e("div",Fa,[e("div",qa,[e("span",Oa,r(s(b)?.form),1),o(E,{modelValue:k.value,"onUpdate:modelValue":a[0]||(a[0]=y=>k.value=y),placeholder:"Select Form",class:"fv-dsw-forms"},{default:f(()=>[(n(!0),i(q,null,O(s(h),y=>(n(),F(m,{key:y.label,label:y.label},{default:f(()=>[(n(!0),i(q,null,O(y.options,$=>(n(),F(u,{key:$.value,label:$.label,value:$.value,onClick:Ta=>j($.value,y)},null,8,["label","value","onClick"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),e("div",Ba,[e("span",null,r(s(b)?.date_range),1),o(pa)]),e("div",xa,[e("span",null,r(s(b)?.filter),1),o(E,{modelValue:C.value,"onUpdate:modelValue":a[1]||(a[1]=y=>C.value=y),placeholder:"Select",class:"fv-dsw-filter"},{default:f(()=>[o(u,{label:s(b).by_day,value:"day"},{default:f(()=>[e("span",null,r(s(b)?.by_day),1)]),_:1},8,["label"]),o(u,{label:s(b).by_week,value:"week"},{default:f(()=>[e("span",null,r(s(b).by_week),1)]),_:1},8,["label"]),o(u,{label:s(b).by_month,value:"month"},{default:f(()=>[e("span",null,r(s(b).by_month),1)]),_:1},8,["label"])]),_:1},8,["modelValue"])])]),e("div",null,[o(ba,{chartData:B.value,chartOptions:W.value},null,8,["chartData","chartOptions"])]),e("div",null,[o(Sa,{dashboardData:L.value,date:s(w),preset:s(T)},null,8,["dashboardData","date","preset"])]),e("div",null,[o(Na,{dashboardData:L.value,date:s(w)},null,8,["dashboardData","date"])])]),_:1})}}};const Ra=K(),R=Y(Aa);R.use(Ra);R.mount("#fv-dashboard-widgets-0");
//# sourceMappingURL=dashBoard.js.map
