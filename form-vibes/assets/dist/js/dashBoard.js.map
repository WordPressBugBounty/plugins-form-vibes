{"version":3,"file":"dashBoard.js","sources":["../../../src/Components/DashboardWidget/chart.vue","../../../src/Components/DashboardWidget/stats.vue","../../../src/Components/DashboardWidget/entry-count.vue","../../../src/Components/DashboardWidget/dashboard.vue","../../../src/dashboard.js"],"sourcesContent":["<script setup>\nimport { watch, ref } from 'vue';\nimport { Line } from 'vue-chartjs';\nimport { Chart as ChartJS, Title, Tooltip, Legend, BarElement, CategoryScale, LinearScale, PointElement, LineElement } from 'chart.js';\n\nChartJS.register(Title, Tooltip, Legend, BarElement, CategoryScale, LinearScale, PointElement, LineElement);\n\nconst props = defineProps(['chartData','chartType', 'chartOptions']);\nconst chartDatas = ref({\n  labels: [],\n  datasets: [\n    {\n      label: '',\n      data: []\n    }\n  ]\n});\n\nwatch([() => props.chartData], () => {\n    chartDatas.value = {\n        labels: props.chartData.labels,\n        datasets: props.chartData.datasets\n    }\n})\n\n</script>\n<template>\n  \n    <div class=\"fv-chart\">\n      \n      <Line :data=\"chartDatas\" height=\"100%\" width=\"100%\" :options = \"chartOptions\"/>\n    </div>\n</template>","<script setup>\nimport { ArrowDown, ArrowDownBold, ArrowUp, ArrowUpBold } from '@element-plus/icons-vue';\nimport { watch, ref } from 'vue';\n\nconst props = defineProps(['dashboardData','date','preset']);\nconst stats = ref(0);\nwatch([() => props.dashboardData], () => {\n    let pc = Number(props.dashboardData?.previousDateRangeDataCount);\n    let te = Number(props.dashboardData?.totalEntries);\n\t\tif (pc <= 0) return;\n    stats.value = Math.ceil(((te - pc) / pc) * 100);\n})\n\n</script>\n<template>\n    \n    <div class=\"fv-stats\">\n      <div class=\"fv-count fv-stats-col\">\n        <span className=\"fv-text-xl\">{{dashboardData?.totalEntries}}</span>\n          <div v-if=\"preset !== 'Custom'\">\n            {{ preset.replaceAll('_', ' ') }}\n          </div>\n          <div v-else>\n            {{ date[0] }} - \n            {{ date[1] }}\n          </div>\n      </div>\n      <div v-if=\"Number(dashboardData?.previousDateRangeDataCount) === 0\" class=\"fv-cmpr fv-stats-col\">\n        No Data to Compare!\n      </div>\n      <div v-else class=\"fv-cmpr fv-stats-col\">\n        <div v-if=\"dashboardData?.totalEntries >= Number(dashboardData?.previousDateRangeDataCount)\">\n          <el-icon><ArrowUpBold /></el-icon>\n          <span>{{stats}}%</span>\n        </div>\n        <div v-else>\n          <el-icon><ArrowDownBold /></el-icon>\n          <span>{{stats}}%</span>\n        </div>\n      </div>\n    </div>\n</template>","<script setup>\nimport { watch, ref } from 'vue';\n\nconst props = defineProps(['dashboardData','date']);\nconst open = ref(false);\nconst handleChange = (val) => {\n    open.value = !open.value;\n}\n</script>\n<template>\n    <div>\n        <el-collapse v-model=\"activeNames\" @change=\"handleChange\">\n            <el-collapse-item :title=\"`Total Entries By Forms (${date[0]} to ${date[1]}) `\">\n                <div v-for=\"(data,index) in dashboardData?.allFormsDataCount\" :key=\"index\" class=\"fv-dbw-form-list-item\">\n                    <span class=\"fv-dbw-form-list\">\n                        {{data.formName}} ({{data.plugin}})\n                    </span>\n                    <span class=\"fv-dbw-form-list-count\">{{data.count}}</span>\n                </div>\n            </el-collapse-item>\n        </el-collapse>\n    </div>\n</template>","<script setup>\nimport { onMounted, ref, watch } from 'vue';\nimport { useFVStore } from '../../stores/formvibes';\nimport { storeToRefs } from 'pinia';\nimport { axiosPost } from '../../Axios/post';\nimport { clearLocalStorage, getFromLocalStorage, setToLocalStorage } from '../../stores/utils';\nimport Chart from './chart.vue';\nimport Stats from './stats.vue';\nimport EntryCount from './entry-count.vue';\nimport datePicker from '../shared/date-picker.vue';\n\nconst store = useFVStore();\nconst {formsSelector,isLoading, generalStates,currentForm, currentPlugin,notice,dates, preset} = storeToRefs(store);\nconst forms = formsSelector.value;\nconst i18n = window.fvGlobalVar?.i18n;\nconst selectedForm = ref(getFromLocalStorage('fv-form'));\nconst selectedFilter = ref(getFromLocalStorage('fv-analytics-filter') || 'month');\nconst chartData = ref([]);\n// const chartOption = ref({\n//     scales: {\n//         y: {\n//             min: 0, // Ensures the y-axis starts at 0\n            \n//         }\n//     }\n// });\n\nconst chartOption = ref({\n    scales: {\n        y: {\n            min: 0, // Ensures the y-axis starts at 0\n            ticks: {\n                stepSize: 1,\n            },\n        }\n    }\n});\nconst chartType = ref('bar');\nconst noData = ref([]);\nconst dashboardData = ref([]);\n\nonMounted( () => {\n\n  if(!selectedForm.value){\n        const firstplugin = forms[0]?.label;\n        const firstform = forms[0]?.options[0]?.value;\n        selectedForm.value = firstform;\n        generalStates.value.queryParams = {\n            ...generalStates.value.queryParams,\n            plugin: firstplugin,\n            formid: firstform,\n        }\n    }\n  getAnalyticsData();\n});\nwatch([selectedForm, () => generalStates.value.queryParams], () => {\n  getAnalyticsData();\n});\n\nconst onChangeForm = (id, e) => {\n    const form = forms.filter((form) => form.label === e.label)[0].options.filter((fm) => fm.value === id)[0];\n    \n    clearLocalStorage(true);\n    setToLocalStorage('fv-form', form);\n    \n    const plugin = form.plugin;\n    const formid = form.value;\n    currentPlugin.value = plugin;\n    currentForm.value = formid;\n\n    generalStates.value = {\n        ...generalStates.value,\n        queryParams: {\n            ...generalStates.value.queryParams,\n            plugin:\n                plugin || (forms?.length > 0 ? forms[0]?.options[0]?.plugin : []),\n            formid:\n                formid || (forms?.length > 0 ? forms[0]?.options[0]?.value : []),        \n        }\n    }\n};\n\nconst getAnalyticsData = async () => {\n    isLoading.value = true;\n    let {queryParams} = generalStates.value;\n    queryParams = {\n      ...queryParams, \n      fromDate: dates.value[0] || '',\n      toDate: dates.value[1] || '',\n    }\n    try {\n        const { data } = await axiosPost({\n            queryParams: {\n                ...queryParams,\n                // filter_type: 'month',\n                dashboard_data: true,\n                allForms: forms,\n            },\n            action: 'fv_get_analytics_data',\n        });\n        const { dashboard_data: dd, ...rest } = data;\n        dashboardData.value = dd;\n        prepareChatData(rest);\n        store.resetError();\n    } catch (error) {\n        notice.value = {\n            ...notice.value,\n            isError: true,\n            message: error.message,\n        };\n    } finally {\n        isLoading.value = false;\n    }\n};\n\nwatch([selectedFilter], () => {\n    setToLocalStorage('fv-analytics-filter', selectedFilter.value);\n    generalStates.value = {\n        ...generalStates.value,\n        queryParams: {\n            ...generalStates.value.queryParams,\n            filter_type: selectedFilter.value\n        }\n    }\n    getAnalyticsData();\n})\n\nconst prepareChatData = (data) => {\n\tconst attributes = [];\n\tattributes.labels = [];\n\tattributes.datasets = [];\n\tattributes.data = [];\n\n\tObject.keys(data).forEach((row) => {\n\t\tattributes.labels.push(data[row].Label);\n\t\tattributes.data.push(data[row].count);\n\t});\n\n\tconst cData = {\n\t\tlabels: attributes.labels,\n\t\tdatasets: [\n\t\t\t{\n\t\t\t\tlabel: 'Leads',\n\t\t\t\tbackgroundColor: '#0071a14D',\n\t\t\t\tborderColor: '#0071a1',\n\t\t\t\tborderWidth: 3,\n\t\t\t\thoverBackgroundColor: '#00aadc',\n\t\t\t\tdata: attributes.data,\n\t\t\t},\n\t\t],\n\t};\n\n\tif (Object.keys(cData).length > 0) {\n\t\tchartData.value = cData;\n\t}\n\tnoData.value = attributes.data.every((d) => d === 0);\n\tisLoading.value = false;\n};\n\n</script>\n<template>\n    <el-config-provider>\n        <div className=\"fv-hidden\" id=\"fv-dashboard-settings\">\n            <div class=\"fv-row fv-form-row\">\n                <span class=\"fv-form-row-label\">{{i18n?.form}}</span>\n                <el-select v-model=\"selectedForm\" placeholder=\"Select Form\" class=\"fv-dsw-forms\">\n                    <el-option-group\n                        v-for=\"group in forms\"\n                        :key=\"group.label\"\n                        :label=\"group.label\"\n                        >\n                        <el-option\n                            v-for=\"item in group.options\"\n                            :key=\"item.value\"\n                            :label=\"item.label\"\n                            :value=\"item.value\"\n                            @click=\"(e) => onChangeForm(item.value,group)\"\n                        />\n                    </el-option-group>\n                </el-select>\n            </div>\n            <div class=\"fv-row fv-form-row \">\n                <span>{{i18n?.date_range}}</span>\n                <datePicker />\n            </div>\n            <div class=\"fv-row fv-form-row\">\n                <span>{{i18n?.filter}}</span>\n                <el-select v-model=\"selectedFilter\" placeholder=\"Select\" class=\"fv-dsw-filter\">\n                    <el-option :label=\"i18n.by_day\" value=\"day\">\n                        <!-- <el-icon ></el-icon> -->\n                        <span>{{i18n?.by_day}}</span>\n                    </el-option>\n                    <el-option :label=\"i18n.by_week\" value=\"week\">\n                        <!-- <el-icon ></el-icon> -->\n                        <span>{{ i18n.by_week }}</span>\n                    </el-option>\n                    <el-option :label=\"i18n.by_month\" value=\"month\">\n                        <!-- <el-icon ></el-icon> -->\n                        <span>{{i18n.by_month}}</span>\n                    </el-option>\n                </el-select>\n            </div>\n        </div>\n      <div>\n        \n       <Chart :chartData=\"chartData\" :chartOptions=\"chartOption\"/>\n      </div>\n      <div>\n        <Stats :dashboardData=\"dashboardData\" :date=\"dates\" :preset=\"preset\"/>\n      </div>\n      <div>\n        <EntryCount :dashboardData=\"dashboardData\" :date=\"dates\"/>\n      </div>\n  </el-config-provider>    \n</template>","import { createApp } from 'vue';\nimport Dashboard from './Components/DashboardWidget/dashboard.vue';\nimport { createPinia } from \"pinia\";\nimport '../node_modules/element-plus/theme-chalk/src/notification.scss';\nimport './Assets/dashboardWidget.scss';\n\nconst pinia = createPinia();\nconst dashboardWidgetApp = createApp(Dashboard);\ndashboardWidgetApp.use(pinia);\n\n\ndashboardWidgetApp.mount('#fv-dashboard-widgets-0');"],"names":["ChartJS","Title","Tooltip","Legend","BarElement","CategoryScale","LinearScale","PointElement","LineElement","props","__props","chartDatas","ref","watch","stats","pc","te","open","handleChange","val","store","useFVStore","formsSelector","isLoading","generalStates","currentForm","currentPlugin","notice","dates","preset","storeToRefs","forms","i18n","selectedForm","getFromLocalStorage","selectedFilter","chartData","chartOption","noData","dashboardData","onMounted","firstplugin","firstform","getAnalyticsData","onChangeForm","id","e","form","fm","clearLocalStorage","setToLocalStorage","plugin","formid","queryParams","data","axiosPost","dd","rest","prepareChatData","error","attributes","row","cData","d","pinia","createPinia","dashboardWidgetApp","createApp","Dashboard"],"mappings":"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"}