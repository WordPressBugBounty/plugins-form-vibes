import{x as v,L as x,A as F,Q as E,o as i,g as L,k as d,h as t,w as c,W as O,X as V,l as g,E as P,ag as M,n as $,ah as W,O as j,J as U,j as R,s as w,a4 as G,ad as H,ae as I,af as J}from"../assets/post-2433f428.js";import{u as N,g as q,s as A}from"../assets/formvibes-4c4994e4.js";import{_ as Q}from"../assets/header-7033ae65.js";import{b as X,d as K,c as Y}from"../assets/select-b70937af.js";import{_ as Z}from"../assets/date-picker-25a0adc5.js";import{v as aa}from"../assets/loading-128c1aab.js";import{C as ea,p as ta,a as sa,b as la,B as oa,c as na,L as ra,P as ca,d as ia,e as ua,f as va}from"../assets/index-4baa6a2e.js";import{E as da}from"../assets/index-2f3cc352.js";/* empty css                      */import"../assets/focus-trap-9b255300.js";import"../assets/date-picker-1de719c3.js";import"../assets/index-8e3cc18a.js";const pa={class:"fv-content-wrapper fv-action-bar-wrapper"},fa=d("div",{class:"fv-page-title"},[d("h3",null,"Analytics")],-1),ma={class:"fv-action-bar"},ha={class:"fv-analytics-controls left"},_a={class:"fv-analytics-controls right"},ya=d("span",null,"By Day",-1),ga=d("span",null,"By Week",-1),ba=d("span",null,"By Month",-1),Da={__name:"analtics-control-bar",props:["getAnalyticsData","chartType","changeChartType"],setup(n){const p=N(),s=v("bar"),f=n,{formsSelector:C,generalStates:l,isNoPlugins:h,isPro:S,dates:T}=x(p),r=C.value,b=v(q("fv-form")),_=v(q("fv-analytics-filter")||"month");F(()=>{if(!b.value){const D=r[0]?.label,a=r[0]?.options[0]?.value;b.value=a,l.value.queryParams={...l.value.queryParams,plugin:D,formid:a}}}),E([s],()=>{f.changeChartType(s),A("fv-chart-type",s)}),E([_],()=>{A("fv-analytics-filter",_.value),l.value={...l.value,queryParams:{...l.value.queryParams,filter_type:_.value}},f.getAnalyticsData()});const k=(D,a)=>{const e=r.filter(y=>y.label===a.label)[0].options.filter(y=>y.value===D)[0],m=e.plugin,u=e.value;A("fv-form",e),l.value={...l.value,queryParams:{...l.value.queryParams,plugin:m||(r?.length>0?r[0]?.options[0]?.plugin:[]),formid:u||(r?.length>0?r[0]?.options[0]?.value:[])}},f.getAnalyticsData()};return(D,a)=>{const e=X,m=K,u=Y,y=U;return i(),L("div",pa,[fa,d("div",ma,[d("div",ha,[t(Z),t(u,{modelValue:b.value,"onUpdate:modelValue":a[0]||(a[0]=o=>b.value=o),placeholder:"Select"},{default:c(()=>[(i(!0),L(O,null,V(g(r),o=>(i(),P(m,{key:o.label,label:o.label},{default:c(()=>[(i(!0),L(O,null,V(o.options,B=>(i(),P(e,{key:B.value,label:B.label,value:B.value,onClick:Ta=>k(B.value,o)},null,8,["label","value","onClick"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),d("div",_a,[t(y,{size:"20",onClick:a[1]||(a[1]=o=>s.value="bar"),class:$([{active:s.value=="bar"},"fv-anyltics-chart"])},{default:c(()=>[t(g(M))]),_:1},8,["class"]),t(y,{size:"20",onClick:a[2]||(a[2]=o=>s.value="line"),class:$([{active:s.value=="line"},"fv-anyltics-chart"])},{default:c(()=>[t(g(W))]),_:1},8,["class"]),t(y,{size:"20",onClick:a[3]||(a[3]=o=>n.getAnalyticsData())},{default:c(()=>[t(g(j))]),_:1}),t(u,{modelValue:_.value,"onUpdate:modelValue":a[4]||(a[4]=o=>_.value=o),placeholder:"Select"},{default:c(()=>[t(e,{label:"By Day",value:"day"},{default:c(()=>[ya]),_:1}),t(e,{label:"By Week",value:"week"},{default:c(()=>[ga]),_:1}),t(e,{label:"By Month",value:"month"},{default:c(()=>[ba]),_:1})]),_:1},8,["modelValue"])])])])}}},Ca={class:"fv-content-wrapper"},ka={class:"fv-chart-wrapper"},La={__name:"chart",props:["chartData","chartOption","chartType","isLoading"],setup(n){ea.register(ta,sa,la,oa,na,ra,ca,ia);const p=n,s=v({labels:[],datasets:[{label:"",data:[]}]});return v({responsive:!0,maintainAspectRatio:!1}),E([()=>p.chartData],()=>{s.value={labels:p.chartData.labels,datasets:p.chartData.datasets}}),(f,C)=>{const l=aa;return i(),L("div",Ca,[R((i(),L("div",ka,[n.chartType=="bar"?(i(),P(g(ua),{key:0,data:s.value,height:"100",options:n.chartOption},null,8,["data","options"])):w("",!0),n.chartType=="line"?(i(),P(g(va),{key:1,data:s.value,height:"100",options:n.chartOption},null,8,["data","options"])):w("",!0)])),[[l,n.isLoading]])])}}},Ea={__name:"analytics",setup(n){const p=N(),{isNoPlugins:s,isLoading:f,generalStates:C,dates:l,notice:h}=x(p),S=v([]),T=v("bar"),r=v([]),b=v({scales:{y:{min:0,ticks:{stepSize:1}}}});F(()=>{k()}),E([()=>C.value.queryParams],()=>{k()});const _=a=>{const e=[];e.labels=[],e.datasets=[],e.data=[],Object.keys(a).forEach(u=>{e.labels.push(a[u].Label),e.data.push(a[u].count)});const m={labels:e.labels,datasets:[{label:"Leads",backgroundColor:"#0071a14D",borderColor:"#0071a1",borderWidth:3,hoverBackgroundColor:"#00aadc",data:e.data}]};Object.keys(m).length>0&&(S.value=m),r.value=e.data.every(u=>u===0)},k=async()=>{if(s.value)return;f.value=!0;let{queryParams:a}=C.value;a={...a,fromDate:l.value[0]||"",toDate:l.value[1]||""};try{const{data:e}=await G({queryParams:a,action:"fv_get_analytics_data"});_(e),p.resetError()}catch(e){h.value={...h.value,isError:!0,message:e.message}}finally{f.value=!1}},D=a=>{T.value=a._value};return E([h],()=>{h.value.message!==""&&da({offset:30,dangerouslyUseHTMLString:!0,message:`<strong>${h.value.message}</strong>`,type:h.value.isError?"error":"success",class:"fv-items-center"})}),(a,e)=>{const m=H;return i(),P(m,null,{default:c(()=>[d("div",null,[t(Q),t(Da,{getAnalyticsData:k,chartType:T.value,changeChartType:D},null,8,["chartType"]),t(La,{chartData:S.value,chartOption:b.value,chartType:T.value,isLoading:g(f)},null,8,["chartData","chartOption","chartType","isLoading"])])]),_:1})}}};const Pa=I(),z=J(Ea);z.use(Pa);z.mount("#fv-analytics");
//# sourceMappingURL=analytics.js.map
